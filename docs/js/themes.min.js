class Util{forEach(a,b){a=a||[];for(let c=0;c<a.length;c++)b(a[c])}getScrollTop(){return document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop}isMobile(){return window.matchMedia("only screen and (max-width: 680px)").matches}isTocStatic(){return window.matchMedia("only screen and (max-width: 960px)").matches}animateCSS(a,b,c,d){Array.isArray(b)||(b=[b]),a.classList.add("animated",...b);const e=()=>{a.classList.remove("animated",...b),a.removeEventListener("animationend",e),"function"==typeof d&&d()};c||a.addEventListener("animationend",e,!1)}}class Theme{constructor(){this.config=window.config,this.data=this.config.data,this.isDark="dark"===document.body.getAttribute("theme"),this.util=new Util,this.newScrollTop=this.util.getScrollTop(),this.oldScrollTop=this.newScrollTop,this.scrollEventSet=new Set,this.resizeEventSet=new Set,this.switchThemeEventSet=new Set,this.clickMaskEventSet=new Set,window.objectFitImages&&objectFitImages()}initSVGIcon(){this.util.forEach(document.querySelectorAll("[data-svg-src]"),a=>{fetch(a.getAttribute("data-svg-src")).then(a=>a.text()).then(b=>{const c=document.createElement("div");c.insertAdjacentHTML("afterbegin",b);const d=c.firstChild;d.setAttribute("data-svg-src",a.getAttribute("data-svg-src")),d.classList.add("icon");const e=d.getElementsByTagName("title");e.length&&d.removeChild(e[0]),a.parentElement.replaceChild(d,a)}).catch(a=>{console.error(a)})})}initTwemoji(){this.config.twemoji&&twemoji.parse(document.body)}initMenuMobile(){const a=document.getElementById("menu-toggle-mobile"),b=document.getElementById("menu-mobile");a.addEventListener("click",()=>{document.body.classList.toggle("blur"),a.classList.toggle("active"),b.classList.toggle("active")},!1),this._menuMobileOnClickMask=this._menuMobileOnClickMask||(()=>{a.classList.remove("active"),b.classList.remove("active")}),this.clickMaskEventSet.add(this._menuMobileOnClickMask)}initSwitchTheme(){this.util.forEach(document.getElementsByClassName("theme-switch"),a=>{a.addEventListener("click",()=>{"dark"===document.body.getAttribute("theme")?document.body.setAttribute("theme","light"):document.body.setAttribute("theme","dark"),this.isDark=!this.isDark,window.localStorage&&localStorage.setItem("theme",this.isDark?"dark":"light");for(let a of this.switchThemeEventSet)a()},!1)})}initDetails(){this.util.forEach(document.getElementsByClassName("details"),a=>{const b=a.getElementsByClassName("details-summary")[0];b.addEventListener("click",()=>{a.classList.toggle("open")},!1)})}initLightGallery(){this.config.lightGallery&&lightGallery(document.getElementById("content"),this.config.lightGallery)}initHighlight(){this.util.forEach(document.querySelectorAll(".highlight > pre.chroma"),a=>{const b=document.createElement("div");b.className=a.className;const c=document.createElement("table");b.appendChild(c);const d=document.createElement("tbody");c.appendChild(d);const e=document.createElement("tr");d.appendChild(e);const f=document.createElement("td");e.appendChild(f),a.parentElement.replaceChild(b,a),f.appendChild(a)}),this.util.forEach(document.querySelectorAll(".highlight > .chroma"),a=>{const b=a.querySelectorAll("pre.chroma > code");if(b.length){const c=b[b.length-1],d=document.createElement("div");d.className="code-header "+c.className.toLowerCase();const e=document.createElement("span");e.classList.add("code-title"),e.insertAdjacentHTML("afterbegin","<i class=\"arrow fas fa-chevron-right fa-fw\"></i>"),e.addEventListener("click",()=>{a.classList.toggle("open")},!1),d.appendChild(e);const f=document.createElement("span");f.insertAdjacentHTML("afterbegin","<i class=\"fas fa-ellipsis-h fa-fw\"></i>"),f.classList.add("ellipses"),f.addEventListener("click",()=>{a.classList.add("open")},!1),d.appendChild(f);const g=document.createElement("span");g.insertAdjacentHTML("afterbegin","<i class=\"far fa-copy fa-fw\"></i>"),g.classList.add("copy");const h=c.innerText;if((0>this.config.code.maxShownLines||h.split("\n").length<this.config.code.maxShownLines+2)&&a.classList.add("open"),this.config.code.copyTitle){g.setAttribute("data-clipboard-text",h),g.title=this.config.code.copyTitle;const a=new ClipboardJS(g);a.on("success",()=>{this.util.animateCSS(c,"flash")}),d.appendChild(g)}a.insertBefore(d,a.firstChild)}})}initTable(){this.util.forEach(document.querySelectorAll(".content table"),a=>{const b=document.createElement("div");b.className="table-wrapper",a.parentElement.replaceChild(b,a),b.appendChild(a)})}initHeaderLink(){for(let a=1;6>=a;a++)this.util.forEach(document.querySelectorAll(".single .content > h"+a),a=>{a.classList.add("headerLink"),a.insertAdjacentHTML("afterbegin",`<a href="#${a.id}" class="header-mark"></a>`)})}initToc(){const a=document.getElementById("TableOfContents");if(null!==a)if(document.getElementById("toc-static").getAttribute("data-kept")||this.util.isTocStatic()){const b=document.getElementById("toc-content-static");a.parentElement!==b&&(a.parentElement.removeChild(a),b.appendChild(a)),this._tocOnScroll&&this.scrollEventSet.delete(this._tocOnScroll)}else{const b=document.getElementById("toc-content-auto");a.parentElement!==b&&(a.parentElement.removeChild(a),b.appendChild(a));const c=document.getElementById("toc-auto"),d=document.getElementsByClassName("page")[0],e=d.getBoundingClientRect();c.style.left=`${e.left+e.width+10}px`,c.style.maxWidth=`${d.getBoundingClientRect().left-10}px`,c.style.visibility="visible";const f=a.querySelectorAll("a:first-child"),g=a.getElementsByTagName("li"),h=document.getElementsByClassName("headerLink"),i="normal"!==document.body.getAttribute("data-header-desktop"),j=document.getElementById("header-desktop").offsetHeight,k=20+(i?j:0),l=c.offsetTop,m=l-k+(i?0:j);this._tocOnScroll=this._tocOnScroll||(()=>{const b=document.getElementById("post-footer").offsetTop,d=b-c.getBoundingClientRect().height,e=d-k+(i?0:j);this.newScrollTop<m?(c.style.position="absolute",c.style.top=`${l}px`):this.newScrollTop>e?(c.style.position="absolute",c.style.top=`${d}px`):(c.style.position="fixed",c.style.top=`${k}px`),this.util.forEach(f,a=>{a.classList.remove("active")}),this.util.forEach(g,a=>{a.classList.remove("has-active")});const n=20+(i?j:0);let o=h.length-1;for(let a=0;a<h.length-1;a++){const b=h[a].getBoundingClientRect().top,c=h[a+1].getBoundingClientRect().top;if(0==a&&b>n||b<=n&&c>n){o=a;break}}if(-1!==o){f[o].classList.add("active");for(let b=f[o].parentElement;b!==a;)b.classList.add("has-active"),b=b.parentElement.parentElement}}),this._tocOnScroll(),this.scrollEventSet.add(this._tocOnScroll)}}initComment(){if(this.config.comment&&this.config.comment.vssue){const a=this.config.comment.vssue;new Vue({el:"#vssue",render:b=>b("Vssue",{props:{title:a.title,options:{owner:a.owner,repo:a.repo,clientId:a.clientID,clientSecret:a.clientSecret}}})})}}onScroll(){const a=[];if("auto"===document.body.getAttribute("data-header-desktop")&&a.push(document.getElementById("header-desktop")),"auto"===document.body.getAttribute("data-header-mobile")&&a.push(document.getElementById("header-mobile")),document.getElementById("comments")){const a=document.getElementById("view-comments");a.href=`#comments`,a.style.display="block"}const b=document.getElementById("fixed-buttons"),c=20;window.addEventListener("scroll",()=>{this.newScrollTop=this.util.getScrollTop();const d=this.newScrollTop-this.oldScrollTop,e=this.util.isMobile();this.util.forEach(a,a=>{d>c?(a.classList.remove("fadeInDown"),this.util.animateCSS(a,["fadeOutUp","faster"],!0)):d<-c&&(a.classList.remove("fadeOutUp"),this.util.animateCSS(a,["fadeInDown","faster"],!0))}),this.newScrollTop>100?e&&d>c?(b.classList.remove("fadeIn"),this.util.animateCSS(b,["fadeOut","faster"],!0)):(!e||d<-c)&&(b.style.display="block",b.classList.remove("fadeOut"),this.util.animateCSS(b,["fadeIn","faster"],!0)):(!e&&(b.classList.remove("fadeIn"),this.util.animateCSS(b,["fadeOut","faster"],!0)),b.style.display="none");for(let a of this.scrollEventSet)a();this.oldScrollTop=this.newScrollTop},!1)}onResize(){window.addEventListener("resize",()=>{this._resizeTimeout||(this._resizeTimeout=window.setTimeout(()=>{this._resizeTimeout=null;for(let a of this.resizeEventSet)a();this.initToc()},100))},!1)}onClickMask(){document.getElementById("mask").addEventListener("click",()=>{for(let a of this.clickMaskEventSet)a();document.body.classList.remove("blur")},!1)}init(){try{this.initSVGIcon(),this.initTwemoji(),this.initMenuMobile(),this.initSwitchTheme(),this.initDetails(),this.initLightGallery(),this.initHighlight(),this.initTable(),this.initHeaderLink()}catch(a){console.error(a)}window.setTimeout(()=>{this.initToc(),this.initComment(),this.onScroll(),this.onResize(),this.onClickMask()},100)}}const themeInit=()=>{const a=new Theme;a.init()};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",themeInit,!1):themeInit();

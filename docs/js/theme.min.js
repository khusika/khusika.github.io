class Util{forEach(e,t){e=e||[];for(let n=0;n<e.length;n++)t(e[n])}getScrollTop(){return document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop}isMobile(){return window.matchMedia("only screen and (max-width: 680px)").matches}isTocStatic(){return window.matchMedia("only screen and (max-width: 1200px)").matches}animateCSS(e,t,n,s){Array.isArray(t)||(t=[t]),e.classList.add("animated",...t);const o=()=>{e.classList.remove("animated",...t),e.removeEventListener("animationend",o),typeof s=="function"&&s()};n||e.addEventListener("animationend",o,!1)}}class Theme{constructor(){this.config=window.config,this.data=this.config.data,this.isDark=document.body.getAttribute("theme")==="dark",this.util=new Util,this.newScrollTop=this.util.getScrollTop(),this.oldScrollTop=this.newScrollTop,this.scrollEventSet=new Set,this.resizeEventSet=new Set,this.switchThemeEventSet=new Set,this.clickMaskEventSet=new Set,window.objectFitImages&&objectFitImages()}initSVGIcon(){this.util.forEach(document.querySelectorAll("[data-svg-src]"),e=>{fetch(e.getAttribute("data-svg-src")).then(e=>e.text()).then(t=>{const s=document.createElement("div");s.insertAdjacentHTML("afterbegin",t);const n=s.firstChild;n.setAttribute("data-svg-src",e.getAttribute("data-svg-src")),n.classList.add("icon");const o=n.getElementsByTagName("title");o.length&&n.removeChild(o[0]),e.parentElement.replaceChild(n,e)}).catch(e=>{console.error(e)})})}initTwemoji(){this.config.twemoji&&twemoji.parse(document.body)}initMenuMobile(){const e=document.getElementById("menu-toggle-mobile"),t=document.getElementById("menu-mobile");e.addEventListener("click",()=>{document.body.classList.toggle("blur"),e.classList.toggle("active"),t.classList.toggle("active")},!1),this._menuMobileOnClickMask=this._menuMobileOnClickMask||(()=>{e.classList.remove("active"),t.classList.remove("active")}),this.clickMaskEventSet.add(this._menuMobileOnClickMask)}initSwitchTheme(){this.util.forEach(document.getElementsByClassName("theme-switch"),e=>{e.addEventListener("click",()=>{document.body.getAttribute("theme")==="dark"?document.body.setAttribute("theme","light"):document.body.setAttribute("theme","dark"),this.isDark=!this.isDark,window.localStorage&&localStorage.setItem("theme",this.isDark?"dark":"light");for(let e of this.switchThemeEventSet)e()},!1)})}initDetails(){this.util.forEach(document.getElementsByClassName("details"),e=>{const t=e.getElementsByClassName("details-summary")[0];t.addEventListener("click",()=>{e.classList.toggle("open")},!1)})}initLightGallery(){this.config.lightGallery&&lightGallery(document.getElementById("content"),this.config.lightGallery)}initHighlight(){this.util.forEach(document.querySelectorAll(".highlight > pre.chroma"),e=>{const t=document.createElement("div");t.className=e.className;const n=document.createElement("table");t.appendChild(n);const s=document.createElement("tbody");n.appendChild(s);const o=document.createElement("tr");s.appendChild(o);const i=document.createElement("td");o.appendChild(i),e.parentElement.replaceChild(t,e),i.appendChild(e)}),this.util.forEach(document.querySelectorAll(".highlight > .chroma"),e=>{const t=e.querySelectorAll("pre.chroma > code");if(t.length){const a=t[t.length-1],s=document.createElement("div");s.className="code-header "+a.className.toLowerCase();const o=document.createElement("span");o.classList.add("code-title"),o.insertAdjacentHTML("afterbegin",'<i class="arrow fas fa-chevron-right fa-fw"></i>'),o.addEventListener("click",()=>{e.classList.toggle("open")},!1),s.appendChild(o);const i=document.createElement("span");i.insertAdjacentHTML("afterbegin",'<i class="fas fa-ellipsis-h fa-fw"></i>'),i.classList.add("ellipses"),i.addEventListener("click",()=>{e.classList.add("open")},!1),s.appendChild(i);const n=document.createElement("span");n.insertAdjacentHTML("afterbegin",'<i class="far fa-copy fa-fw"></i>'),n.classList.add("copy");const r=a.innerText;if((this.config.code.maxShownLines<0||r.split(`
`).length<this.config.code.maxShownLines+2)&&e.classList.add("open"),this.config.code.copyTitle){n.setAttribute("data-clipboard-text",r),n.title=this.config.code.copyTitle;const e=new ClipboardJS(n);e.on("success",e=>{this.util.animateCSS(a,"flash")}),s.appendChild(n)}e.insertBefore(s,e.firstChild)}})}initTable(){this.util.forEach(document.querySelectorAll(".content table"),e=>{const t=document.createElement("div");t.className="table-wrapper",e.parentElement.replaceChild(t,e),t.appendChild(e)})}initHeaderLink(){for(let e=1;e<=6;e++)this.util.forEach(document.querySelectorAll(".single .content > h"+e),e=>{e.classList.add("headerLink"),e.insertAdjacentHTML("afterbegin",`<a href="#${e.id}" class="header-mark"></a>`)})}initToc(){const e=document.getElementById("TableOfContents");if(e===null)return;if(document.getElementById("toc-static").getAttribute("data-kept")||this.util.isTocStatic()){const t=document.getElementById("toc-content-static");e.parentElement!==t&&(e.parentElement.removeChild(e),t.appendChild(e)),this._tocOnScroll&&this.scrollEventSet.delete(this._tocOnScroll)}else{const r=document.getElementById("toc-content-auto");e.parentElement!==r&&(e.parentElement.removeChild(e),r.appendChild(e));const t=document.getElementById("toc-auto"),c=document.getElementsByClassName("page")[0],l=c.getBoundingClientRect();t.style.left=`${l.left+l.width+10}px`,t.style.maxWidth=`${c.getBoundingClientRect().left-10}px`,t.style.visibility="visible";const a=e.querySelectorAll("a:first-child"),u=e.getElementsByTagName("li"),n=document.getElementsByClassName("headerLink"),o=document.body.getAttribute("data-header-desktop")!=="normal",s=document.getElementById("header-desktop").offsetHeight,i=20+(o?s:0),d=t.offsetTop,h=d-i+(o?0:s);this._tocOnScroll=this._tocOnScroll||(()=>{const m=document.getElementById("post-footer").offsetTop,l=m-t.getBoundingClientRect().height,f=l-i+(o?0:s);this.newScrollTop<h?(t.style.position="absolute",t.style.top=`${d}px`):this.newScrollTop>f?(t.style.position="absolute",t.style.top=`${l}px`):(t.style.position="fixed",t.style.top=`${i}px`),this.util.forEach(a,e=>{e.classList.remove("active")}),this.util.forEach(u,e=>{e.classList.remove("has-active")});const c=20+(o?s:0);let r=n.length-1;for(let e=0;e<n.length-1;e++){const t=n[e].getBoundingClientRect().top,s=n[e+1].getBoundingClientRect().top;if(e==0&&t>c||t<=c&&s>c){r=e;break}}if(r!==-1){a[r].classList.add("active");let t=a[r].parentElement;for(;t!==e;)t.classList.add("has-active"),t=t.parentElement.parentElement}}),this._tocOnScroll(),this.scrollEventSet.add(this._tocOnScroll)}}initComment(){if(this.config.comment&&this.config.comment.vssue){const e=this.config.comment.vssue;new Vue({el:"#vssue",render:t=>t("Vssue",{props:{title:e.title,options:{owner:e.owner,repo:e.repo,clientId:e.clientID,clientSecret:e.clientSecret}}})})}}onScroll(){const n=[];if(document.body.getAttribute("data-header-desktop")==="auto"&&n.push(document.getElementById("header-desktop")),document.body.getAttribute("data-header-mobile")==="auto"&&n.push(document.getElementById("header-mobile")),document.getElementById("comments")){const e=document.getElementById("view-comments");e.href=`#comments`,e.style.display="block"}const e=document.getElementById("fixed-buttons"),t=20,s=100;window.addEventListener("scroll",()=>{this.newScrollTop=this.util.getScrollTop();const o=this.newScrollTop-this.oldScrollTop,i=this.util.isMobile();this.util.forEach(n,e=>{o>t?(e.classList.remove("fadeInDown"),this.util.animateCSS(e,["fadeOutUp","faster"],!0)):o<-t&&(e.classList.remove("fadeOutUp"),this.util.animateCSS(e,["fadeInDown","faster"],!0))}),this.newScrollTop>s?i&&o>t?(e.classList.remove("fadeIn"),this.util.animateCSS(e,["fadeOut","faster"],!0)):(!i||o<-t)&&(e.style.display="block",e.classList.remove("fadeOut"),this.util.animateCSS(e,["fadeIn","faster"],!0)):(i||(e.classList.remove("fadeIn"),this.util.animateCSS(e,["fadeOut","faster"],!0)),e.style.display="none");for(let e of this.scrollEventSet)e();this.oldScrollTop=this.newScrollTop},!1)}onResize(){window.addEventListener("resize",()=>{this._resizeTimeout||(this._resizeTimeout=window.setTimeout(()=>{this._resizeTimeout=null;for(let e of this.resizeEventSet)e();this.initToc()},100))},!1)}onClickMask(){document.getElementById("mask").addEventListener("click",()=>{for(let e of this.clickMaskEventSet)e();document.body.classList.remove("blur")},!1)}init(){try{this.initSVGIcon(),this.initTwemoji(),this.initMenuMobile(),this.initSwitchTheme(),this.initDetails(),this.initLightGallery(),this.initHighlight(),this.initTable(),this.initHeaderLink()}catch(e){console.error(e)}window.setTimeout(()=>{this.initToc(),this.initComment(),this.onScroll(),this.onResize(),this.onClickMask()},100)}}const themeInit=()=>{const e=new Theme;e.init()};document.readyState!=="loading"?themeInit():document.addEventListener("DOMContentLoaded",themeInit,!1)